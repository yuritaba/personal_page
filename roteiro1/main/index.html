<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Yuri Tabacof"><link href=https://yuritaba.github.io/personal_page/roteiro1/main/ rel=canonical><link rel=prev href=../..><link href=../../roteiro2/main/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.6.21"><title>1. Data - Yuri Tabacof – Personal Page</title><link rel=stylesheet href=../../assets/stylesheets/main.2a3383ac.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/_markdown_exec_pyodide.css><link rel=stylesheet href=../../assets/_markdown_exec_ansi.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#roteiro-data class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Yuri Tabacof – Personal Page" class="md-header__button md-logo" aria-label="Yuri Tabacof – Personal Page" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Yuri Tabacof – Personal Page </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> 1. Data </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=grey data-md-color-accent=indigo aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/yuritaba/personal_page title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> yuritaba/personal_page </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Yuri Tabacof – Personal Page" class="md-nav__button md-logo" aria-label="Yuri Tabacof – Personal Page" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Yuri Tabacof – Personal Page </label> <div class=md-nav__source> <a href=https://github.com/yuritaba/personal_page title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg> </div> <div class=md-source__repository> yuritaba/personal_page </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Exercises </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Exercises </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> 1. Data </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> 1. Data </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#visao-geral-do-pipeline class=md-nav__link> <span class=md-ellipsis> Visão geral do pipeline </span> </a> </li> <li class=md-nav__item> <a href=#exercicio-1 class=md-nav__link> <span class=md-ellipsis> Exercício 1 </span> </a> <nav class=md-nav aria-label="Exercício 1"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analyze-and-draw-boundaries class=md-nav__link> <span class=md-ellipsis> Analyze and Draw Boundaries: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-2 class=md-nav__link> <span class=md-ellipsis> Exercício 2 </span> </a> <nav class=md-nav aria-label="Exercício 2"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analyzing-the-plots class=md-nav__link> <span class=md-ellipsis> Analyzing the Plots: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-3 class=md-nav__link> <span class=md-ellipsis> Exercício 3 </span> </a> <nav class=md-nav aria-label="Exercício 3"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#describing-the-data class=md-nav__link> <span class=md-ellipsis> Describing the Data: </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../roteiro2/main/ class=md-nav__link> <span class=md-ellipsis> 2. Perceptron </span> </a> </li> <li class=md-nav__item> <a href=../../roteiro3/main/ class=md-nav__link> <span class=md-ellipsis> 3. MLP </span> </a> </li> <li class=md-nav__item> <a href=../../roteiro4/main/ class=md-nav__link> <span class=md-ellipsis> 4. Metrics </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Projeto </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Projeto </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../projeto1/main/ class=md-nav__link> <span class=md-ellipsis> 1. Projeto </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#visao-geral-do-pipeline class=md-nav__link> <span class=md-ellipsis> Visão geral do pipeline </span> </a> </li> <li class=md-nav__item> <a href=#exercicio-1 class=md-nav__link> <span class=md-ellipsis> Exercício 1 </span> </a> <nav class=md-nav aria-label="Exercício 1"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analyze-and-draw-boundaries class=md-nav__link> <span class=md-ellipsis> Analyze and Draw Boundaries: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-2 class=md-nav__link> <span class=md-ellipsis> Exercício 2 </span> </a> <nav class=md-nav aria-label="Exercício 2"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#analyzing-the-plots class=md-nav__link> <span class=md-ellipsis> Analyzing the Plots: </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#exercicio-3 class=md-nav__link> <span class=md-ellipsis> Exercício 3 </span> </a> <nav class=md-nav aria-label="Exercício 3"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#describing-the-data class=md-nav__link> <span class=md-ellipsis> Describing the Data: </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=roteiro-data>Roteiro - Data</h1> <p>Este relatório contém: geração dos dados (Ex.1 e Ex.2), visualizações e pré-processamento do Spaceship Titanic (Ex.3), com análise explicativa.</p> <h2 id=visao-geral-do-pipeline>Visão geral do pipeline</h2> <pre class=mermaid><code>flowchart LR
  A[Ex.1: Dados 2D Gauss] --&gt; B[Visualização &amp; Fronteiras]
  C[Ex.2: Dados 5D MVN] --&gt; D[PCA 5→2 e Scatter]
  E[Ex.3: Kaggle Titanic] --&gt; F[Limpeza &amp; Escala tanh]
  B --&gt; G[Análises]
  D --&gt; G
  F --&gt; G</code></pre> <h2 id=exercicio-1>Exercício 1</h2> <p>Geração e plotagem dos dados (o output do md exec não funciona com plt.show, então o gráfico da saída é mostrado abaixo do código como imagem): </p> <p>obs: ajuda de IA</p> <p> <script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js></script> <script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script> <script type=text/javascript src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js></script> <link title=light rel="alternate stylesheet" href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css disabled=disabled> <link title=dark rel="alternate stylesheet" href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css disabled=disabled> <div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span id=exec-4--run title="Run: press Ctrl-Enter" class="pyodide-bar-item pyodide-clickable"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre id=exec-4--editor class=pyodide-editor>import numpy as np
import matplotlib.pyplot as plt

rng = np.random.default_rng(42)

# Parâmetros fornecidos
means = {
    0: np.array([2.0, 3.0]),
    1: np.array([5.0, 6.0]),
    2: np.array([8.0, 1.0]),
    3: np.array([15.0, 14.0]),
}
stds = {
    0: np.array([0.8, 2.5]),
    1: np.array([1.2, 1.9]),
    2: np.array([0.9, 0.9]),
    3: np.array([0.5, 2.0]),
}

X_list, y_list = [], []
for k in range(4):
    mu = means[k]
    sd = stds[k]
    cov = np.diag(sd**2)
    Xi = rng.multivariate_normal(mu, cov, size=100)
    yi = np.full(100, k)
    X_list.append(Xi)
    y_list.append(yi)

X = np.vstack(X_list)
y = np.concatenate(y_list)

# Scatter por classe
fig, ax = plt.subplots(figsize=(6,5))
for k, color in zip(range(4), ["tab:blue","tab:orange","tab:green","tab:red"]):
    ax.scatter(X[y==k,0], X[y==k,1], s=18, alpha=0.85, label=f"Classe {k}", c=color)

ax.set_title("Ex.1 — Dados 2D (4 classes, gaussianas)")
ax.set_xlabel("x1")
ax.set_ylabel("x2")
ax.legend(loc="best", frameon=True)
ax.grid(True, ls=":")
plt.show()
</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span id=exec-4--clear class="pyodide-bar-item pyodide-clickable"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code id=exec-4--output class=pyodide-output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-4--',
        install=['numpy', ' matplotlib'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=43,
        maxLines=43,
    );
});
</script> </p> <p><img alt="Ex.1 — Dados 2D (4 classes gaussianas)" src=../ex1.png></p> <h3 id=analyze-and-draw-boundaries>Analyze and Draw Boundaries:</h3> <ul> <li>Examine the scatter plot carefully. Describe the distribution and overlap of the four classes.</li> </ul> <p>Red is isolated in the top right, green is isolated in the bottom right (but close to blue and orange clusters), blue is mostly on the left side with some spread, and orange is in the middle overlapping a little bit with blue.</p> <ul> <li>Based on your visual inspection, could a simple, linear boundary separate all classes?</li> </ul> <p>No, because it is impossible to separate class 0 and 1 using a line. This means that a linear model would not be able to classify these points correctly.</p> <ul> <li>On your plot, sketch the decision boundaries that you think a trained neural network might learn to separate these classes.</li> </ul> <p>It should probably look something like this:</p> <p><img alt="Ex.1 — Dados 2D com fronteiras" src=../ex1_boundaries.png></p> <h2 id=exercicio-2>Exercício 2</h2> <p>Generating the Data</p> <p> <script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js></script> <script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script> <script type=text/javascript src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js></script> <link title=light rel="alternate stylesheet" href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css disabled=disabled> <link title=dark rel="alternate stylesheet" href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css disabled=disabled> <div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span id=exec-5--run title="Run: press Ctrl-Enter" class="pyodide-bar-item pyodide-clickable"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre id=exec-5--editor class=pyodide-editor>
import numpy as np
import matplotlib.pyplot as plt

rng = np.random.default_rng(123)

miA = np.zeros(5)
SomA = np.array([
    [1,   0.8, 0.1, 0,   0  ],
    [0.8, 1,   0.3, 0,   0  ],
    [0.1, 0.3, 1,   0.5, 0  ],
    [0,   0,   0.5, 1,   0.2],
    [0,   0,   0,   0.2, 1  ],
], dtype=float)

miB = np.full(5, 1.5)
SomB = np.array([
    [1.5, -0.7, 0.2, 0,   0  ],
    [-0.7, 1.5, 0.4, 0,   0  ],
    [0.2,  0.4, 1.5, 0.6, 0  ],
    [0,    0,   0.6, 1.5, 0.3],
    [0,    0,   0,   0.3, 1.5],
], dtype=float)

def nearest_psd(M, eps=1e-8):
    # Corrige PSD numericamente (clipe de autovalores)
    w, v = np.linalg.eigh(M)
    w = np.clip(w, eps, None)
    return (v * w) @ v.T

SomA = nearest_psd(SomA)
SomB = nearest_psd(SomB)

XA = rng.multivariate_normal(miA, SomA, size=500)
XB = rng.multivariate_normal(miB, SomB, size=500)

X5 = np.vstack([XA, XB])
y5 = np.array([0]*500 + [1]*500)

# PCA via SVD
Xc = X5 - X5.mean(axis=0, keepdims=True)
U, S, Vt = np.linalg.svd(Xc, full_matrices=False)
# Componentes principais nas colunas de V (linhas de Vt)
W = Vt[:2].T            # 5x2
X2 = Xc @ W             # projeção 2D

# variância explicada
explained = (S**2) / (len(X5)-1)
ratio = explained / explained.sum()
var_ratio = ratio[:2]

fig, ax = plt.subplots(figsize=(6,5))
ax.scatter(X2[y5==0,0], X2[y5==0,1], s=14, alpha=0.7, label="Classe A", c="tab:blue")
ax.scatter(X2[y5==1,0], X2[y5==1,1], s=14, alpha=0.7, label="Classe B", c="tab:red")
ax.set_title(f"Ex.2 — PCA (5D→2D), variância explicada PC1+PC2 = {var_ratio.sum():.3f}")
ax.set_xlabel("PC1"); ax.set_ylabel("PC2")
ax.legend(frameon=True); ax.grid(True, ls=":")
plt.show()
</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span id=exec-5--clear class="pyodide-bar-item pyodide-clickable"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code id=exec-5--output class=pyodide-output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-5--',
        install=['numpy', ' matplotlib'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=57,
        maxLines=57,
    );
});
</script> </p> <p><img alt="Plot do exercício 2" src=../ex2.png></p> <h3 id=analyzing-the-plots>Analyzing the Plots:</h3> <ul> <li>Based on your 2D projection, describe the relationship between the two classes.</li> </ul> <p>The two classes are heavily overlapping in the 2D projection, therefore it would be impossible to separate them with high accuracy using only two dimension.</p> <ul> <li>Discuss the linear separability of the data. Explain why this type of data structure poses a challenge for simple linear models and would likely require a multi-layer neural network with non-linear activation functions to be classified accurately.</li> </ul> <p>The data is not linearly separable in the 2D projection, as there is significant overlap between the two classes. This means that no straight line can be drawn to separate all points of one class from the other. Simple linear models, such as logistic regression or linear SVMs, rely on finding a linear decision boundary to classify data points. Therefore, a multi-layer neural network with non-linear activation functions is necessary to capture the complex relationships and patterns in the data, allowing for more flexible decision boundaries that can better separate the classes.</p> <h2 id=exercicio-3>Exercício 3</h2> <h3 id=describing-the-data>Describing the Data:</h3> <p>Briefly describe the dataset's objective (i.e., what does the Transported column represent?).</p> <p>O objetivo é prever a coluna Transported, que indica se o passageiro foi transportado para outra dimensão (True ou False).</p> <p>List the features and identify which are numerical (e.g., Age, RoomService) and which are categorical (e.g., HomePlanet, Destination).</p> <p>Features numéricas:</p> <ul> <li>Age, RoomService, FoodCourt, ShoppingMall, Spa, VRDeck.</li> </ul> <p>Features categóricas:</p> <ul> <li>HomePlanet, CryoSleep, Cabin (deck/num/side), Destination, VIP, Name.</li> </ul> <p>Identificadores:</p> <ul> <li>PassengerId (não usado como feature preditiva).</li> </ul> <p>Investigate the dataset for missing values. Which columns have them, and how many?</p> <p>Rodando o código abaixo (não irá funcionar aqui com o markdown exec, mas funciona no Python localmente):</p> <p> <script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js></script> <script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script> <script type=text/javascript src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js></script> <link title=light rel="alternate stylesheet" href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css disabled=disabled> <link title=dark rel="alternate stylesheet" href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css disabled=disabled> <div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span id=exec-6--run title="Run: press Ctrl-Enter" class="pyodide-bar-item pyodide-clickable"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre id=exec-6--editor class=pyodide-editor>import pandas as pd

# carregar dados
import pandas as pd
url = "https://yuritaba.github.io/personal_page/roteiro1/spaceship-titanic/train.csv"
df = pd.read_csv(url)
na_counts = df.isna().sum().sort_values(ascending=False)
na_counts.head(15)</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span id=exec-6--clear class="pyodide-bar-item pyodide-clickable"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code id=exec-6--output class=pyodide-output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-6--',
        install=['pandas'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=8,
        maxLines=8,
    );
});
</script> </p> <p>Output:</p> <div class=highlight><pre><span></span><code>CryoSleep       217
ShoppingMall    208
VIP             203
HomePlanet      201
Name            200
Cabin           199
VRDeck          188
FoodCourt       183
Spa             183
Destination     182
RoomService     181
Age             179
PassengerId       0
Transported       0
dtype: int64
</code></pre></div> <p>Logo, as colunas com valores ausentes são todas exceto PassengerId e Transported.</p> <p>Preprocess the Data: Your goal is to clean and transform the data so it can be fed into a neural network. The tanh activation function produces outputs in the range [-1, 1], so your input data should be scaled appropriately for stable training.</p> <ul> <li> <p>Encode Categorical Features: Convert categorical columns like HomePlanet, CryoSleep, and Destination into a numerical format. One-hot encoding is a good choice.</p> </li> <li> <p>Normalize/Standardize Numerical Features: Scale the numerical columns (e.g., Age, RoomService, etc.). Since the tanh activation function is centered at zero and outputs values in [-1, 1], Standardization (to mean 0, std 1) or Normalization to a [-1, 1] range are excellent choices. Implement one and explain why it is a good practice for training neural networks with this activation function.</p> </li> </ul> <p>Primeiramente fazemos um one-hot encoding das colunas categóricas, depois lidamos com os valores ausentes (imputação), e também normalizamos as colunas numéricas para o intervalo [-1, 1].</p> <p>(Novamente, o código abaixo não irá funcionar aqui com o markdown exec, mas funciona no Python localmente):</p> <p>obs: ajuda de IA</p> <p> <script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/ace/1.16.0/ace.js></script> <script type=text/javascript src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script> <script type=text/javascript src=https://cdn.jsdelivr.net/pyodide/v0.26.4/full/pyodide.js></script> <link title=light rel="alternate stylesheet" href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow.min.css disabled=disabled> <link title=dark rel="alternate stylesheet" href=https://cdn.jsdelivr.net/npm/highlightjs-themes@1.0.0/tomorrow-night-blue.min.css disabled=disabled> <div class=pyodide> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Editor (session: default)</span><span id=exec-7--run title="Run: press Ctrl-Enter" class="pyodide-bar-item pyodide-clickable"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M8 5.14v14l11-7-11-7Z"></path></svg></span> Run</span> </div> <div><pre id=exec-7--editor class=pyodide-editor>
# separar target
y = df["Transported"].astype(int)
X = df.drop(columns=["Transported","PassengerId","Name"])

# separar colunas categóricas e numéricas
num_cols = ["Age","RoomService","FoodCourt","ShoppingMall","Spa","VRDeck"]
cat_cols = ["HomePlanet","CryoSleep","Cabin","Destination","VIP"]

# one-hot encoding manual
X_cat = []
for col in cat_cols:
    uniques = sorted(X[col].dropna().unique())
    mapping = {val:i for i,val in enumerate(uniques)}
    arr = np.zeros((len(X), len(uniques)))
    for i, val in enumerate(X[col]):
        if pd.isna(val):
            continue
        arr[i, mapping[val]] = 1
    X_cat.append(arr)
X_cat = np.concatenate(X_cat, axis=1) if X_cat else np.empty((len(X),0))

# imputar valores numéricos (mediana)
for col in num_cols:
    median = X[col].median()
    X[col] = X[col].fillna(median)

# normalizar numéricas para [-1,1]
X_num = X[num_cols].values.astype(float)
mins = X_num.min(axis=0)
maxs = X_num.max(axis=0)
X_num_scaled = 2 * (X_num - mins) / (maxs - mins) - 1

# juntar numéricas e categóricas
X_proc = np.concatenate([X_num_scaled, X_cat], axis=1)

df.head()</pre></div> <div class=pyodide-editor-bar> <span class=pyodide-bar-item>Output</span><span id=exec-7--clear class="pyodide-bar-item pyodide-clickable"><span class=twemoji><svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M15.14 3c-.51 0-1.02.2-1.41.59L2.59 14.73c-.78.77-.78 2.04 0 2.83L5.03 20h7.66l8.72-8.73c.79-.77.79-2.04 0-2.83l-4.85-4.85c-.39-.39-.91-.59-1.42-.59M17 18l-2 2h7v-2"></path></svg></span> Clear</span> </div> <pre><code id=exec-7--output class=pyodide-output></code></pre> </div> <script>
document.addEventListener('DOMContentLoaded', (event) => {
    setupPyodide(
        'exec-7--',
        install=['pandas', ' numpy', ' matplotlib'],
        themeLight='tomorrow',
        themeDark='tomorrow_night',
        session='default',
        minLines=36,
        maxLines=36,
    );
});
</script> </p> <ul> <li>Numéricas → preenchidas com a mediana de cada coluna.</li> </ul> <p>A mediana é robusta contra outliers, evitando distorções no escalonamento para [-1,1].</p> <ul> <li>Categóricas → no one-hot, valores nulos não viraram nenhuma categoria ativa (linha de zeros).</li> </ul> <p>Isso equivale a tratar o missing como uma “categoria ausente” sem inventar valores, mantendo consistência no vetor de entrada.</p> <p>Visualize the Results:</p> <p>Create histograms for one or two numerical features (like FoodCourt or Age) before and after scaling to show the effect of your transformation.</p> <p><img alt="Histogramas antes e depois da normalização" src=../ex3.png></p> <p>Como esperado, a "proporção" continua a mesma, mas agora os valores estão entre -1 e 1, adequados para a tanh.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.copy", "navigation.top", "navigation.tracking", "navigation.expand"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.f55a23d4.min.js></script> <script src=../../assets/_markdown_exec_pyodide.js></script> <script src=https://unpkg.com/mermaid@10/dist/mermaid.min.js></script> <script src=https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js></script> </body> </html>